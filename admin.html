<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Administration ici.c'est.PARIS</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-wrap {
            max-width: 800px;
            margin: 50px auto;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border-top: 5px solid var(--paris-blue);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 800;
            margin-bottom: 8px;
            color: var(--paris-blue);
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #EEE;
            border-radius: 10px;
            font-family: inherit;
        }

        .actions {
            display: flex;
            gap: 10px;
        }

        .btn-add {
            background: var(--paris-blue);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 900;
        }

        .btn-add:hover {
            background: var(--paris-red);
        }

        #auth-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--paris-blue);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #auth-modal {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>

<body>
    <div id="auth-screen">
        <div id="auth-modal">
            <h2 style="margin-bottom: 20px;">Acc√®s Boutique Officielle</h2>
            <input type="password" id="admin-pass" placeholder="Mot de passe">
            <button class="btn-add" style="margin-top: 15px;" onclick="checkAuth()">ENTRER</button>
        </div>
    </div>

    <div class="admin-wrap" id="admin-interface" style="display:none;">
        <h1 style="color:var(--paris-blue); margin-bottom: 30px;">Gestion ici.c'est.PARIS</h1>
        <div id="firebase-status" style="margin-bottom: 20px; padding: 15px; border-radius: 10px; font-weight: 700;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <span id="status-icon">‚è≥</span> <span id="status-text">V√©rification de la connexion
                        Firebase...</span>
                </div>
                <button onclick="testFirebaseConnection()"
                    style="padding: 5px 15px; border-radius: 5px; border:none; background:#003366; color:white; cursor:pointer; font-weight:bold; font-size:12px;">TESTER
                    DIAGNOSTIC üõ†Ô∏è</button>
            </div>
            <div id="test-results"
                style="margin-top:10px; padding-top:10px; border-top:1px solid rgba(0,0,0,0.1); font-size:12px; display:none;">
            </div>
        </div>

        <div class="form-group">
            <label>Nom du Produit</label>
            <input type="text" id="p-name" placeholder="ex: Ensemble Nike Tech Green">
        </div>
        <div class="form-group">
            <label>Cat√©gorie</label>
            <select id="p-cat">
                <option value="Homme">Homme</option>
                <option value="Femme">Femme</option>
                <option value="Chaussures">Chaussures</option>
                <option value="Accessoires">Accessoires</option>
            </select>
        </div>
        <div class="form-group">
            <label>Taille(s) disponibles (s√©par√©es par des virgules)</label>
            <input type="text" id="p-sizes" placeholder="ex: S, M, L, XL ou 40, 41, 42">
        </div>
        <div class="form-group marathon-row" style="display:flex; gap:15px;">
            <div style="flex:1">
                <label>Prix (DA) *</label>
                <input type="number" id="p-price" placeholder="38500" min="0" step="1" required>
                <small id="price-preview" style="display:none; color:#666; font-size:12px; margin-top:5px;"></small>
            </div>
            <div style="flex:1">
                <label>Statut</label>
                <select id="p-stock">
                    <option value="in">En Stock</option>
                    <option value="out">Rupture</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label>Image du produit (URL ou Upload)</label>
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <input type="text" id="p-img" placeholder="https://... (Image Principale)" onchange="updatePreview()">
                <label for="p-file" class="upload-btn"
                    style="cursor: pointer; background: var(--paris-blue); color: white; padding: 10px 15px; border-radius: 8px; font-size: 14px;">
                    üì∏ Upload (Max 4)
                </label>
                <input type="file" id="p-file" accept="image/*" multiple style="display: none;"
                    onchange="handleImageUpload(this)">
            </div>
            <small style="color: #666; font-size: 11px;">S√©lectionnez jusqu'√† 4 images. La premi√®re sera l'image
                principale.</small>

            <!-- Gallery Preview -->
            <div id="gallery-preview" style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                <!-- Thumbnails will appear here -->
            </div>
        </div>

        <!-- Hidden canvas for compression -->
        <canvas id="compress-canvas" style="display: none;"></canvas>

        <button class="btn-add" onclick="addProduct()">PUBLIER SUR LA BOUTIQUE</button>

        <hr style="margin: 40px 0; border: 1px solid #EEE;">
        <h3>Aper√ßu du Flux Direct</h3>
        <p style="font-size: 13px; color: #666;">Les modifications appara√Ætront instantan√©ment sur le site d√®s que
            Firebase sera configur√©.</p>
        <style>
            .product-item {
                display: flex;
                align-items: center;
                gap: 15px;
                padding: 15px;
                background: #f8f9fa;
                border: 1px solid #eee;
                border-radius: 10px;
                margin-bottom: 10px;
            }

            .product-item img {
                width: 50px;
                height: 50px;
                object-fit: cover;
                border-radius: 5px;
            }

            .product-info {
                flex: 1;
            }

            .product-actions {
                display: flex;
                gap: 10px;
            }

            .btn-edit {
                background: #ffc107;
                color: #000;
                border: none;
                padding: 5px 10px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
            }

            .btn-delete {
                background: #dc3545;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
            }
        </style>

        <div id="product-list-container" style="margin-top: 30px;">
            <h3>üì¶ Inventaire Actuel</h3>
            <div id="product-list">
                <p style="text-align: center; color: #666;">Chargement des produits...</p>
            </div>
        </div>
    </div>

    <script>
        /**
         * Firebase Configuration for Admin Panel
         * 
         * IMPORTANT: Replace these placeholder values with your actual Firebase credentials
         * Get them from: Firebase Console > Project Settings > General > Your apps
         * 
         * Security Rules Required (Firebase Console > Realtime Database > Rules):
         * {
         *   "rules": {
         *     "products": {
         *       ".read": true,
         *       ".write": "auth != null || root.child('admin').child('enabled').val() == true"
         *     }
         *   }
         * }
         */
        const firebaseConfig = {
            apiKey: "AIzaSyAGnZtxU3qb47Wfa9D33u-NFllnawt4rCY",
            authDomain: "ici-cest-paris-4e9d5.firebaseapp.com",
            databaseURL: "https://ici-cest-paris-4e9d5-default-rtdb.firebaseio.com",
            projectId: "ici-cest-paris-4e9d5",
            storageBucket: "ici-cest-paris-4e9d5.firebasestorage.app",
            messagingSenderId: "307044964156",
            appId: "1:307044964156:web:9fe8757d90a24abe5eb039",
            measurementId: "G-YF7V1CKQVR"
        };

        let database;

        // Check if Firebase config is still using placeholder values
        const isPlaceholderConfig = firebaseConfig.apiKey.includes('EXAMPLE') ||
            firebaseConfig.apiKey === 'AIzaSyAs-EXAMPLE-PLACEHOLDER';

        if (isPlaceholderConfig) {
            console.warn("‚ö†Ô∏è Firebase config uses placeholder values!");
            console.log("üìù Please update firebaseConfig in admin.html with your actual Firebase credentials");

            // Show warning in UI
            setTimeout(() => {
                const adminWrap = document.getElementById('admin-interface');
                if (adminWrap) {
                    const warning = document.createElement('div');
                    warning.style.cssText = `
                        background: #fff3cd;
                        border: 2px solid #ffc107;
                        color: #856404;
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 20px;
                        font-weight: 700;
                    `;
                    warning.innerHTML = `
                        ‚ö†Ô∏è <strong>Firebase non configur√©!</strong><br>
                        Les produits ne seront pas sauvegard√©s en ligne tant que Firebase n'est pas configur√©.<br>
                        Consultez FIREBASE_SETUP.md pour les instructions.
                    `;
                    adminWrap.insertBefore(warning, adminWrap.firstChild);
                }
            }, 500);
        }

        try {
            if (typeof firebase !== 'undefined') {
                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                console.log("‚úÖ Firebase Admin initialized successfully");

                // Test connection
                database.ref('.info/connected').on('value', (snap) => {
                    if (snap.val() === true) {
                        console.log("‚úÖ Connected to Firebase");
                    } else {
                        console.warn("‚ö†Ô∏è Not connected to Firebase");
                    }
                });
            } else {
                console.error("‚ùå Firebase SDK not loaded");
                alert("‚ö†Ô∏è Firebase SDK non charg√©. V√©rifiez votre connexion internet.");
            }
        } catch (error) {
            console.error("‚ùå Firebase initialization error:", error);
            if (error.code === 'app/duplicate-app') {
                console.log("‚ÑπÔ∏è Firebase app already initialized");
                database = firebase.database();
            } else {
                alert("‚ö†Ô∏è Erreur d'initialisation Firebase: " + error.message);
            }
        }

        function checkAuth() {
            if (document.getElementById('admin-pass').value === 'paris2026') {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('admin-interface').style.display = 'block';
            } else { alert("Mot de passe incorrect !"); }
        }

        // Format price with commas
        function formatPrice(price) {
            const numPrice = parseInt(price);
            if (isNaN(numPrice)) return price;
            return numPrice.toLocaleString('fr-FR');
        }

        // Update price preview
        function updatePricePreview() {
            const priceInput = document.getElementById('p-price');
            const preview = document.getElementById('price-preview');
            const price = priceInput.value.trim();

            if (price && !isNaN(price) && parseInt(price) > 0) {
                const formatted = formatPrice(price);
                preview.textContent = `Aper√ßu: ${formatted} DA`;
                preview.style.display = 'block';
                preview.style.color = '#28a745';
            } else if (price) {
                preview.textContent = '‚ö†Ô∏è Veuillez entrer un prix valide';
                preview.style.display = 'block';
                preview.style.color = '#dc3545';
            } else {
                preview.style.display = 'none';
            }
        }

        // Add event listener for price input
        document.addEventListener('DOMContentLoaded', () => {
            const priceInput = document.getElementById('p-price');
            if (priceInput) {
                priceInput.addEventListener('input', updatePricePreview);
                priceInput.addEventListener('blur', updatePricePreview);
            }
        });

        function addProduct() {
            // Validate inputs
            const name = document.getElementById('p-name').value.trim();
            const priceInput = document.getElementById('p-price');
            const price = priceInput.value.trim();
            const image = document.getElementById('p-img').value.trim();
            const sizes = document.getElementById('p-sizes').value.trim();

            if (!name || !price || !image) {
                alert("‚ö†Ô∏è Veuillez remplir tous les champs obligatoires (Nom, Prix, Image)");
                return;
            }

            // Validate price is a valid number
            const numPrice = parseInt(price);
            if (isNaN(numPrice) || numPrice <= 0) {
                alert("‚ö†Ô∏è Veuillez entrer un prix valide (nombre sup√©rieur √† 0)");
                priceInput.focus();
                return;
            }

            if (!database) {
                alert("‚ùå Firebase n'est pas configur√©. Veuillez configurer Firebase pour enregistrer en ligne.");
                return;
            }

            // Determine ID (New or Existing)
            const id = currentEditId ? currentEditId : Date.now();
            const formattedPrice = formatPrice(price);

            // Sync main image input with array if needed
            if (document.getElementById('p-img').value !== (currentImages[0] || '')) {
                // If user manually typed a URL, add it to start of array
                const manualUrl = document.getElementById('p-img').value;
                if (manualUrl && !currentImages.includes(manualUrl)) {
                    currentImages.unshift(manualUrl);
                }
            }
            // Fallback for single image legacy
            if (currentImages.length === 0 && image) currentImages.push(image);

            const product = {
                id: id,
                name: name,
                category: document.getElementById('p-cat').value,
                price: numPrice,
                displayPrice: formattedPrice + " DA",
                image: image, // Keep main URL for compatibility
                images: currentImages, // NEW: Full gallery
                sizes: sizes ? sizes.split(',').map(s => s.trim()).filter(s => s) : ["Standard"],
                stock: document.getElementById('p-stock').value,
                updatedAt: new Date().toISOString()
            };

            // Keep original creation date if editing
            if (!currentEditId) {
                product.createdAt = new Date().toISOString();
            } else {
                // Fetch original createdAt if possible, or just ignore (it's fine)
            }

            // Show loading state
            const btn = document.querySelector('.btn-add');
            const originalText = btn.textContent;
            btn.textContent = currentEditId ? "Sauvegarde..." : "Publication en cours...";
            btn.disabled = true;

            const updatePromise = currentEditId
                ? database.ref('products/' + id).update(product)
                : database.ref('products/' + id).set(product);

            updatePromise
                .then(() => {
                    console.log("‚úÖ Product saved to Firebase:", product);
                    alert(currentEditId ? "‚úÖ Modification enregistr√©e !" : "‚úÖ Produit ajout√© avec succ√®s !");

                    // Reset form & Exit Edit Mode
                    document.getElementById('p-name').value = '';
                    document.getElementById('p-price').value = '';
                    document.getElementById('p-img').value = '';
                    document.getElementById('p-sizes').value = '';
                    document.getElementById('p-price').value = '';
                    document.getElementById('price-preview').style.display = 'none';
                    // document.getElementById('img-preview').style.display = 'none'; 
                    currentImages = []; // Reset Array
                    updateGalleryPreview(); // Reset UI

                    // Reset Button
                    currentEditId = null;
                    btn.textContent = "PUBLIER SUR LA BOUTIQUE";
                    btn.style.background = "var(--paris-blue)";
                    btn.style.color = "white";
                    btn.disabled = false;
                })
                .catch(e => {
                    console.error("‚ùå Firebase error:", e);
                    let errorMsg = "‚ùå Erreur: " + e.message;
                    alert(errorMsg);
                    btn.textContent = originalText;
                    btn.disabled = false;
                });
        }

        // Update Firebase status indicator
        function updateFirebaseStatus(connected, message) {
            const statusDiv = document.getElementById('firebase-status');
            const statusIcon = document.getElementById('status-icon');
            const statusText = document.getElementById('status-text');

            if (!statusDiv) return;

            if (connected) {
                statusDiv.style.background = '#d4edda';
                statusDiv.style.border = '2px solid #28a745';
                statusDiv.style.color = '#155724';
                statusIcon.textContent = '‚úÖ';
                statusText.textContent = message || 'Connect√© √† Firebase';
            } else {
                statusDiv.style.background = '#f8d7da';
                statusDiv.style.border = '2px solid #dc3545';
                statusDiv.style.color = '#721c24';
                statusIcon.textContent = '‚ùå';
                statusText.textContent = message || 'Non connect√© √† Firebase';
            }
        }

        // Check Firebase connection status
        if (database) {
            database.ref('.info/connected').on('value', (snap) => {
                if (snap.val() === true) {
                    updateFirebaseStatus(true, '‚úÖ Connect√© √† Firebase - Les produits seront sauvegard√©s en ligne');
                } else {
                    updateFirebaseStatus(false, '‚ùå Non connect√© - V√©rifiez votre configuration Firebase');
                }
            });

            // Add real-time product preview and list render
            database.ref('products').on('value', (snapshot) => {
                const products = snapshot.val();
                const listContainer = document.getElementById('product-list');
                const previewText = document.querySelector('.admin-wrap h3 + p');

                if (!products) {
                    if (listContainer) listContainer.innerHTML = '<p style="text-align:center">Aucun produit.</p>';
                    return;
                }

                const count = Object.keys(products).length;
                if (previewText) {
                    previewText.textContent = `Les modifications appara√Ætront instantan√©ment sur le site. ${count} produit(s) actuellement en ligne.`;
                }

                // Render List
                if (listContainer) {
                    listContainer.innerHTML = '';
                    Object.values(products).reverse().forEach(p => {
                        const div = document.createElement('div');
                        div.className = 'product-item';
                        div.innerHTML = `
                            <img src="${p.image}" onerror="this.src='https://placehold.co/50'">
                            <div class="product-info">
                                <div style="font-weight:bold;">${p.name}</div>
                                <div style="font-size:12px; color:#666;">${p.displayPrice} - ${p.stock === 'in' ? '‚úÖ En Stock' : 'üî¥ Rupture'}</div>
                                <div style="font-size:11px; color:#999;">ID: ${p.id}</div>
                            </div>
                            <div class="product-actions">
                                <button class="btn-edit" onclick="editProduct(${p.id})">‚úèÔ∏è</button>
                                <button class="btn-delete" onclick="deleteProduct(${p.id})">üóëÔ∏è</button>
                            </div>
                        `;
                        listContainer.appendChild(div);
                    });
                }
            });
        } else {
            updateFirebaseStatus(false, '‚ùå Firebase non configur√© - Consultez FIREBASE_SETUP.md');
        }

        // --- MANAGEMENT FUNCTIONS ---
        let currentEditId = null;

        function deleteProduct(id) {
            if (confirm("‚ö†Ô∏è √ätes-vous s√ªr de vouloir supprimer ce produit ? Cette action est irr√©versible.")) {
                database.ref('products/' + id).remove()
                    .then(() => alert("Produit supprim√© ! üóëÔ∏è"))
                    .catch(e => alert("Erreur: " + e.message));
            }
        }

        function editProduct(id) {
            database.ref('products/' + id).once('value').then(snap => {
                const p = snap.val();
                if (!p) return;

                // Fill form
                document.getElementById('p-name').value = p.name;
                document.getElementById('p-cat').value = p.category || 'Homme';
                document.getElementById('p-sizes').value = (p.sizes || []).join(', ');
                document.getElementById('p-price').value = p.price;
                document.getElementById('p-stock').value = p.stock;
                document.getElementById('p-img').value = p.image;

                // Load gallery images
                currentImages = p.images || [p.image];
                updateGalleryPreview();

                updatePricePreview();
                updatePreview();

                // Set Edit Mode
                currentEditId = p.id;
                const btn = document.querySelector('.btn-add');
                btn.textContent = "üíæ SAUVEGARDER LES MODIFICATIONS";
                btn.style.background = "#ffc107";
                btn.style.color = "#000";

                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // Diagnostic Function
        // --- CAMERA ROLL / FILE UPLOAD LOGIC ---
        // --- MULTI-IMAGE UPLOAD LOGIC ---
        let currentImages = []; // Array to store multiple Base64 strings

        function handleImageUpload(input) {
            if (input.files && input.files.length > 0) {
                const files = Array.from(input.files).slice(0, 4); // Limit to 4

                // Reset if new selection
                // currentImages = []; // Optional: Clear previous or append? Let's clear for simplicity.
                // Actually, existing behavior usually expects clear on new selection.

                const label = document.querySelector('.upload-btn');
                const originalText = label.textContent;
                label.textContent = "‚è≥ Traitement...";

                let processedCount = 0;
                const tempImages = [];

                files.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const img = new Image();
                        img.src = e.target.result;
                        img.onload = function () {
                            const canvas = document.getElementById('compress-canvas');
                            const ctx = canvas.getContext('2d');

                            // Resize logic
                            const MAX_WIDTH = 800;
                            const MAX_HEIGHT = 800;
                            let width = img.width;
                            let height = img.height;

                            if (width > height) {
                                if (width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; }
                            } else {
                                if (height > MAX_HEIGHT) { width *= MAX_HEIGHT / height; height = MAX_HEIGHT; }
                            }

                            canvas.width = width;
                            canvas.height = height;
                            ctx.drawImage(img, 0, 0, width, height);

                            // Compress (0.6 quality for gallery)
                            const dataUrl = canvas.toDataURL('image/jpeg', 0.6);
                            tempImages[index] = dataUrl; // Keep order

                            processedCount++;
                            if (processedCount === files.length) {
                                // All done
                                currentImages = tempImages.filter(x => x); // Remove empty
                                updateGalleryPreview();

                                // Set main image input
                                if (currentImages.length > 0) {
                                    document.getElementById('p-img').value = currentImages[0];
                                }

                                label.textContent = "‚úÖ " + currentImages.length + " Images";
                                setTimeout(() => label.textContent = originalText, 2000);
                            }
                        }
                    }
                    reader.readAsDataURL(file);
                });
            }
        }

        function updateGalleryPreview() {
            const container = document.getElementById('gallery-preview');
            container.innerHTML = '';

            currentImages.forEach((img, idx) => {
                const div = document.createElement('div');
                div.style.cssText = 'position: relative; width: 60px; height: 60px; border: 1px solid #ddd; border-radius: 5px; overflow: hidden;';

                const imageEl = document.createElement('img');
                imageEl.src = img;
                imageEl.style.cssText = 'width: 100%; height: 100%; object-fit: cover;';

                const removeBtn = document.createElement('span');
                removeBtn.innerHTML = '√ó';
                removeBtn.style.cssText = 'position: absolute; top: 0; right: 0; background: red; color: white; width: 15px; height: 15px; font-size: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer;';
                removeBtn.onclick = () => {
                    currentImages.splice(idx, 1);
                    updateGalleryPreview();
                    if (currentImages.length > 0) {
                        document.getElementById('p-img').value = currentImages[0];
                    } else {
                        document.getElementById('p-img').value = '';
                    }
                };

                div.appendChild(imageEl);
                div.appendChild(removeBtn);
                container.appendChild(div);
            });

            // Also sync manual URL input if changed manually
            // (Not handled here deeply, assuming upload button is primary)
        }

        function updatePreview() {
            const url = document.getElementById('p-img').value;
            const preview = document.getElementById('img-preview');
            if (url) {
                preview.src = url;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
            }
        }

        // --- END CAMERA ROLL LOGIC ---

        function testFirebaseConnection() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = 'üîÑ D√©marrage du diagnostic...<br>';

            if (!database) {
                resultsDiv.innerHTML += '<span style="color:red">‚ùå Erreur: Database non initialis√©e.</span>';
                return;
            }

            const testRef = database.ref('_connection_test');
            const testData = { timestamp: Date.now(), status: 'test' };

            // Step 1: Write
            resultsDiv.innerHTML += 'üìù Tentative d\'√©criture... ';
            testRef.set(testData)
                .then(() => {
                    resultsDiv.innerHTML += '<span style="color:green">OK ‚úÖ</span><br>';

                    // Step 2: Read
                    resultsDiv.innerHTML += 'üìñ Tentative de lecture... ';
                    return testRef.once('value');
                })
                .then((snap) => {
                    const val = snap.val();
                    if (val && val.timestamp === testData.timestamp) {
                        resultsDiv.innerHTML += '<span style="color:green">OK ‚úÖ</span><br>';
                        resultsDiv.innerHTML += '<strong style="color:green">üéâ SYST√àME OP√âRATIONNEL √Ä 100%</strong>';

                        // Cleanup
                        testRef.remove();
                    } else {
                        throw new Error("Donn√©es corrompues ou non correspondantes");
                    }
                })
                .catch((error) => {
                    resultsDiv.innerHTML += `<span style="color:red">√âCHEC ‚ùå</span><br>`;
                    resultsDiv.innerHTML += `<div style="background:#fff3cd; color:#856404; padding:5px; margin-top:5px; border-radius:5px;">‚ö†Ô∏è Erreur: ${error.message}<br>Code: ${error.code || 'N/A'}</div>`;

                    if (error.code === 'PERMISSION_DENIED') {
                        resultsDiv.innerHTML += '<br>üì¢ <strong>Solution:</strong> V√©rifiez les R√®gles de S√©curit√© (Realtime Database -> Rules). Elles doivent √™tre √† ".read": true et ".write": true pour le d√©veloppement.';
                    }
                });
        }
    </script>
</body>

</html>