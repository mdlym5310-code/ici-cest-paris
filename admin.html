<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ici.c'est.PARIS | Administration S√©curis√©e</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        :root {
            --paris-blue: #003366;
            --paris-red: #E30613;
            --bg-light: #F4F7F6;
            --white: #FFFFFF;
            --text-dark: #1A1A1A;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            margin: 0;
        }

        .admin-login-screen {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--paris-blue) 0%, #001f3f 100%);
        }

        .login-box {
            background: var(--white);
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            width: 100%;
            max-width: 450px;
            border-top: 8px solid var(--paris-red);
        }

        .login-box h1 {
            font-family: 'Playfair Display', serif;
            color: var(--paris-blue);
            font-size: 32px;
            margin-bottom: 30px;
        }

        .login-box input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid #EEE;
            border-radius: 10px;
            font-size: 16px;
            outline: none;
            transition: 0.3s;
        }

        .login-box input:focus {
            border-color: var(--paris-blue);
        }

        .login-btn {
            width: 100%;
            padding: 18px;
            background: var(--paris-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 800;
            cursor: pointer;
            font-size: 16px;
        }

        /* --- DASHBOARD LAYOUT --- */
        .admin-dashboard {
            display: none;
            height: 100vh;
            grid-template-columns: 280px 1fr;
        }

        .sidebar {
            background: var(--paris-blue);
            color: white;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .sidebar h2 {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 20px;
        }

        .nav-item {
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-item:hover,
        .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-item.logout {
            margin-top: auto;
            color: #FF6B6B;
        }

        .main-content {
            padding: 40px;
            overflow-y: auto;
        }

        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid var(--paris-blue);
        }

        .stat-card.red {
            border-left-color: var(--paris-red);
        }

        .stat-card h4 {
            margin: 0;
            color: #888;
            font-size: 14px;
            text-transform: uppercase;
        }

        .stat-card p {
            font-size: 28px;
            font-weight: 800;
            margin: 10px 0 0;
        }

        .editor-view {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 30px;
        }

        .form-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .list-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .p-row {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #F5F5F5;
        }

        .p-row img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }

        .p-row-info {
            flex: 1;
        }

        .p-row-info b {
            font-size: 14px;
        }

        .p-row-info span {
            font-size: 12px;
            color: #888;
        }

        .action-btns {
            display: flex;
            gap: 10px;
        }

        .btn-sm {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 700;
        }

        .btn-del {
            background: #FFE5E5;
            color: #D63031;
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #DDD;
            border-radius: 8px;
            font-family: inherit;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            font-weight: 700;
            color: #555;
        }
    </style>
</head>

<body>

    <!-- Professional Login Screen -->
    <div id="auth-overlay" class="admin-login-screen">
        <div class="login-box">
            <h1>ici.c'est.PARIS <br> <small style="font-size: 14px; opacity: 0.6;">DASHBOARD</small></h1>
            <input type="password" id="admin-pass" placeholder="Password d'acc√®s">
            <button class="login-btn" onclick="checkAuth()">ENTRER DANS LE SYST√àME</button>
            <p id="auth-error" style="color:var(--paris-red); margin-top:20px; font-weight: 700; display:none;">Acc√®s
                Interdit.</p>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-content" class="admin-dashboard">
        <aside class="sidebar">
            <h2>PARIS ADMIN</h2>
            <div class="nav-item active">üõí Produits</div>
            <div class="nav-item">üìà Statistiques</div>
            <div class="nav-item">‚öôÔ∏è Param√®tres</div>
            <div class="nav-item logout" onclick="location.reload()">üîí D√©connexion</div>
        </aside>

        <main class="main-content">
            <div class="header-bar">
                <h1 style="font-family: 'Playfair Display', serif;">Gestion de la Boutique</h1>
                <span id="live-time"
                    style="font-weight: 700; color: var(--paris-blue); background: white; padding: 10px 20px; border-radius: 30px;"></span>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Total Produits</h4>
                    <p id="stat-count">0</p>
                </div>
                <div class="stat-card red">
                    <h4>Promotions Actives</h4>
                    <p id="stat-promo">0</p>
                </div>
                <div class="stat-card">
                    <h4>Visites Aujourd'hui</h4>
                    <p>En direct...</p>
                </div>
            </div>

            <div class="editor-view">
                <div class="form-section">
                    <h3 style="margin-top: 0; color: var(--paris-blue);">Nouveau Produit</h3>
                    <br>
                    <label>Nom du Produit</label>
                    <input type="text" id="p-name" placeholder="ex: Nike Tech Fleece">

                    <label>Cat√©gorie</label>
                    <select id="p-category">
                        <option value="Homme">Homme</option>
                        <option value="Chaussures">Chaussures</option>
                        <option value="Accessoires">Accessoires</option>
                        <option value="Nouveaut√©s">Nouveaut√©s</option>
                    </select>

                    <label>Prix (DA)</label>
                    <input type="number" id="p-price" placeholder="38500">

                    <label>Prix avant Remise (Optionnel)</label>
                    <input type="number" id="p-old-price" placeholder="45000">

                    <label>Image (Lien ou nom du fichier)</label>
                    <input type="text" id="p-image" placeholder="nike-tech.jpg">

                    <button class="login-btn" style="background: var(--paris-red);" onclick="saveToFirebase()">PUBLIER
                        SUR LE SITE</button>
                </div>

                <div class="list-section">
                    <h3 style="margin-top: 0; color: var(--paris-blue);">Inventaire Live</h3>
                    <br>
                    <div id="p-list-sync">
                        <!-- Items will sync here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
    <script>
        // Set live time
        setInterval(() => {
            const now = new Date();
            document.getElementById('live-time').innerText = now.toLocaleTimeString();
        }, 1000);

        function checkAuth() {
            const pass = document.getElementById('admin-pass').value;
            if (pass === "paris2026") {
                document.getElementById('auth-overlay').style.display = 'none';
                document.getElementById('admin-content').style.display = 'grid'; // Grid for dashboard
                loadFirebaseData();
            } else {
                document.getElementById('auth-error').style.display = 'block';
            }
        }

        function saveToFirebase() {
            const name = document.getElementById('p-name').value;
            const cat = document.getElementById('p-category').value;
            const price = parseInt(document.getElementById('p-price').value);
            const oldPrice = parseInt(document.getElementById('p-old-price').value) || null;
            const img = document.getElementById('p-image').value;

            if (!name || !price || !img) return alert("Champs obligatoires manquants.");

            const newProductRef = database.ref('products').push();
            newProductRef.set({
                id: Date.now(),
                name: name,
                category: cat,
                price: price,
                oldPrice: oldPrice,
                displayPrice: price.toLocaleString() + " DA",
                image: img
            }).then(() => {
                alert("Produit mis en ligne !");
                document.getElementById('p-name').value = '';
                document.getElementById('p-price').value = '';
                document.getElementById('p-old-price').value = '';
                document.getElementById('p-image').value = '';
            });
        }

        function loadFirebaseData() {
            database.ref('products').on('value', (snapshot) => {
                const data = snapshot.val();
                const list = document.getElementById('p-list-sync');
                list.innerHTML = '';
                let promoCount = 0;
                let totalCount = 0;

                if (data) {
                    Object.keys(data).forEach(key => {
                        const p = data[key];
                        totalCount++;
                        if (p.oldPrice) promoCount++;

                        list.innerHTML += `
                            <div class="p-row">
                                <img src="${p.image}" onerror="this.src='https://placehold.co/100x100'">
                                <div class="p-row-info">
                                    <b>${p.name}</b><br>
                                    <span>${p.displayPrice} ${p.oldPrice ? '<b style="color:red">-PROMO</b>' : ''}</span>
                                </div>
                                <div class="action-btns">
                                    <button class="btn-sm btn-del" onclick="deleteProduct('${key}')">Supprimer</button>
                                </div>
                            </div>
                        `;
                    });
                }
                document.getElementById('stat-count').innerText = totalCount;
                document.getElementById('stat-promo').innerText = promoCount;
            });
        }

        function deleteProduct(key) {
            if (confirm("Confirmer la suppression ?")) {
                database.ref('products/' + key).remove();
            }
        }
    </script>
</body>

</html>